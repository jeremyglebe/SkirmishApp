"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6902],{6902:(E,c,e)=>{e.r(c),e.d(c,{WarbandEditorPage:()=>v});var u=e(5861),m=e(6895),r=e(433),i=e(7151),p=e(2408),t=e(1571),g=e(9430),h=e(2218);function U(o,l){if(1&o){const n=t.EpF();t.TgZ(0,"ion-item")(1,"ion-avatar",6),t.NdJ("click",function(){const d=t.CHM(n).$implicit,_=t.oxw();return t.KtG(_.viewUnit(d))}),t._UZ(2,"img",7),t.qZA(),t.TgZ(3,"ion-checkbox",8),t.NdJ("ionChange",function(){const d=t.CHM(n).$implicit,_=t.oxw();return t.KtG(_.toggleUnitSelection(d))}),t._uU(4),t._UZ(5,"br"),t._uU(6),t._UZ(7,"br"),t._uU(8),t.qZA()()}if(2&o){const n=l.$implicit,a=t.oxw();t.xp6(2),t.Q6J("src",n.image||"assets/default-unit-image.png",t.LSH),t.xp6(1),t.Q6J("checked",a.isUnitInWarband(n)),t.xp6(1),t.hij(" ",n.name,""),t.xp6(2),t.hij(" Quality: ",n.quality,""),t.xp6(2),t.hij(" Cost: ",a.unitService.calcUnitCost(n),"pts ")}}let v=(()=>{class o{constructor(n,a,s,d,_){this.navCtrl=n,this.route=a,this.fb=s,this.unitService=d,this.modalController=_,this.allUnits=[],this.allUnits=this.unitService.getUnits();const b=this.route.snapshot.queryParamMap.get("warband");this.warband=b?JSON.parse(b):null,this.warbandForm=this.fb.group({name:[this.warband?this.warband.name:"",r.kI.required],description:[this.warband?this.warband.description:"",r.kI.required]}),this.units=this.warband?this.warband.units:[]}toggleUnitSelection(n){const a=this.units.findIndex(s=>s.id===n.id);-1===a?this.units.push(n):this.units.splice(a,1)}saveWarband(){var n=this;return(0,u.Z)(function*(){const a={...n.warbandForm.value,units:n.units};n.warband?n.unitService.updateWarband({...n.warband,...a}):n.unitService.createWarband(a),n.navCtrl.navigateBack("/warbands-list")})()}viewUnit(n){var a=this;return(0,u.Z)(function*(){yield(yield a.modalController.create({component:p.ViewUnitPage,componentProps:{unit:n}})).present()})()}isUnitInWarband(n){return this.units.some(a=>a.id===n.id)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(i.SH),t.Y36(g.gz),t.Y36(r.qu),t.Y36(h._),t.Y36(i.IN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-warband-editor"]],standalone:!0,features:[t.jDz],decls:21,vars:4,consts:[["slot","start"],[3,"formGroup"],["formControlName","name","label","Warband Name"],["formControlName","description","label","Warband Description"],[4,"ngFor","ngForOf"],["expand","full",3,"disabled","click"],["slot","start",3,"click"],[3,"src"],["labelPlacement","fixed",3,"checked","ionChange"]],template:function(n,a){1&n&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button"),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA()()(),t.TgZ(6,"ion-content")(7,"form",1)(8,"ion-item"),t._UZ(9,"ion-input",2),t.qZA(),t.TgZ(10,"ion-item"),t._UZ(11,"ion-textarea",3),t.qZA()(),t.TgZ(12,"ion-list-header")(13,"ion-label"),t._uU(14,"Available Units"),t.qZA()(),t.TgZ(15,"ion-list")(16,"ion-item"),t._uU(17,"Click on a unit's avatar to view it's full description."),t.qZA(),t.YNc(18,U,9,5,"ion-item",4),t.qZA(),t.TgZ(19,"ion-button",5),t.NdJ("click",function(){return a.saveWarband()}),t._uU(20,"Save Warband"),t.qZA()()),2&n&&(t.xp6(5),t.Oqu(a.warband?"Edit Warband":"Create Warband"),t.xp6(2),t.Q6J("formGroup",a.warbandForm),t.xp6(11),t.Q6J("ngForOf",a.allUnits),t.xp6(1),t.Q6J("disabled",!a.warbandForm.valid))},dependencies:[i.Pc,i.BJ,i.oU,i.YG,i.Sm,i.nz,i.W2,i.Gu,i.pK,i.Ie,i.Q$,i.q_,i.yh,i.g2,i.wd,i.sr,i.w,i.j9,i.cs,m.ez,m.sg,r.UX,r._Y,r.JJ,r.JL,r.sg,r.u]}),o})()}}]);