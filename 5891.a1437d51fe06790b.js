"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5891],{5891:(b,m,c)=>{c.r(m),c.d(m,{UnitEditorPage:()=>E});var g=c(5861),o=c(7151),a=c(433);const p=[{name:"Armored",description:"Whenever this unit takes a hit roll one die, on a 4+ it is ignored (doesn\u2019t stack with cover terrain).",cost:15},{name:"Camouflaged",description:"This unit always counts as being in cover terrain.",cost:5},{name:"Tough I",description:"This model only rolls on the wounds table after accumulating 2 wounds and is only killed on a 7+.",cost:15},{name:"Tough II",description:"This model only rolls on the wounds table after accumulating 3 wounds and is only killed on an 8+.",cost:30},{name:"Fearless",description:"This unit may re-roll failed morale tests unless it is Stunned.",cost:10},{name:"Regeneration",description:"Whenever this unit would be killed roll one die, on a 4+ it is Stunned instead.",cost:20},{name:"Unwavering",description:"This unit is not routed by failed morale tests for losing half their army.",cost:5},{name:"Hit & Run",description:"When charging this unit may move back by 3\u201d after attacking, and enemies can\u2019t strike back.",cost:10},{name:"Intimidating",description:"Enemy units without this rule must take a morale test when in melee with it. If failed they must re-roll successful hits.",cost:10},{name:"Frenzy",description:"This unit may re-roll failed hit rolls in melee.",cost:5},{name:"Impact",description:"This unit gains one additional attack roll in melee when charging.",cost:5},{name:"Counter-Attack",description:"Enemies attacking this unit in melee that roll a 1 immediately take one hit themselves.",cost:5},{name:"Shooter I",description:'This unit may shoot with a range of 9".',cost:5},{name:"Shooter II",description:'This unit may shoot with a range of 18".',cost:10},{name:"Shooter III",description:'This unit may shoot with a range of 27".',cost:15},{name:"Deadly",description:"Whenever this unit rolls a 6 to hit it deals one automatic wound (can\u2019t be ignored by the armored rule).",cost:10},{name:"Fire/Poison",description:"When dealing wounds to an enemy add +1 to the wound roll.",cost:10},{name:"Freeze",description:"When dealing hits to an enemy roll one die, on a 4+ it may not move during its next activation.",cost:5},{name:"Powerful I",description:"This unit rolls 2 dice instead of 1 when attacking.",cost:10},{name:"Powerful II",description:"This unit rolls 3 dice instead of 1 when attacking.",cost:20},{name:"Indirect",description:"This unit may shoot through obstructions when any friendly unit has direct line of sight to the target (requires Shooter).",cost:5},{name:"Sniper",description:"When shooting, this unit ignores cover terrain effects (requires Shooter).",cost:5},{name:"Pinning",description:"Select a target and roll one die, on a 4+ the target and any units within 3\u201d each take a morale test. If failed, they must remain idle the next activation (requires Shooter).",cost:10},{name:"Leader",description:"When this unit is activated roll 3 dice, for each 4+ one friendly unit within 6\u201d may take one action.",cost:30},{name:"Death Blow",description:"If this unit is killed all units within 3\u201d take one automatic hit.",cost:5},{name:"Healer",description:"Whenever a friendly unit within 3\u201d would be killed roll one die, on a 4+ it is Stunned instead.",cost:10},{name:"Hero",description:'Friendly units within 12" of this unit may use its rank for morale tests unless it is Stunned.',cost:5},{name:"Large",description:"This unit may re-roll failed hits in melee against non-large units. Enemies may re-roll hits when shooting at it.",cost:0},{name:"Small",description:"This unit must re-roll hits in melee against non-small units. Enemies must re-roll hits when shooting at it.",cost:0},{name:"Fast",description:"This unit moves +2\u201d on advance and +4\u201d on rush/charge actions.",cost:5},{name:"Slow",description:"This unit moves -2\u201d on advance and -4\u201d on rush/charge actions.",cost:-5},{name:"Stealthy",description:"This unit is deployed after all non-stealthy units. Place it anywhere over 9\u201d away from enemy units, and if both players have stealthy units they must roll-off to see who deploys first.",cost:5},{name:"Strider",description:"This unit may move through difficult terrain as if it was open terrain.",cost:5},{name:"Flying",description:"This unit may move through units and obstacles, ignoring terrain effects.",cost:10},{name:"Aquatic",description:"This unit may move through water features as if it was open terrain.",cost:5},{name:"Wizard/Psychic",description:"This unit may cast one power at any time during its activation before attacking. Roll one die, on a 4+ apply one of these effects: \u2022 Fireball: Target enemy unit within 12\u201d takes one hit with Fire. \u2022 Ice Ray: Target enemy unit within 18\u201d takes one hit with Freeze.",cost:15}];var u=c(6895),h=c(3442),e=c(1571),f=c(2218),v=c(9430);const _=["fileInput"];function y(n,r){if(1&n&&(e.TgZ(0,"ion-select-option",15),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.AsE(" ",t.value,"+ (",t.cost,"pts) ")}}function w(n,r){if(1&n&&(e.TgZ(0,"div",22)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.description)}}function k(n,r){1&n&&e._UZ(0,"ion-icon",23)}const T=function(n){return{selected:n}};function x(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"ion-item")(1,"div",18),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.toggleEdgeExpansion(l))}),e.TgZ(2,"div"),e._uU(3),e.qZA(),e.YNc(4,w,3,1,"div",19),e.qZA(),e.TgZ(5,"div",20),e.NdJ("click",function(s){const d=e.CHM(t).$implicit;return e.oxw(2).toggleEdge(d),e.KtG(s.stopPropagation())}),e.YNc(6,k,1,0,"ion-icon",21),e.qZA()()}if(2&n){const t=r.$implicit,i=e.oxw(2);e.xp6(3),e.AsE("",t.name," (",t.cost,"pts)"),e.xp6(1),e.Q6J("ngIf",i.expandedRules.includes(t.name)),e.xp6(1),e.Q6J("ngClass",e.VKq(5,T,i.ruleIsSelected(t))),e.xp6(1),e.Q6J("ngIf",i.ruleIsSelected(t))}}function I(n,r){if(1&n&&(e.TgZ(0,"div",16),e.YNc(1,x,7,7,"ion-item",17),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.edges)}}function U(n,r){if(1&n&&(e.TgZ(0,"ion-item")(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.AsE("",t.unitForm.value.name," will cost ",t.totalCost,"pts")}}function S(n,r){if(1&n&&(e.TgZ(0,"ion-item")(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.AsE("",t.unitForm.value.name,"'s number of edges is ",t.unitForm.value.edges.length,"! The maximum is typically 3 by the standard rules. You can still create it, but it may not be allowed at some games.")}}let E=(()=>{class n{constructor(t,i,s){this.navCtrl=t,this.unitService=i,this.route=s,this.paramID=null,this.rankOptions=[],this.edges=p,this.edgesSelected=[],this.expandedRules=[],this.showRules=!1,this.editing=!1;for(let l in h.k)this.rankOptions.push({value:parseInt(l),cost:h.k[l]});this.unitForm=new a.cw({name:new a.NI("",a.kI.required),rank:new a.NI("",a.kI.required),edges:new a.NI([]),image:new a.NI("")})}ngOnInit(){var t=this;return(0,g.Z)(function*(){if(t.paramID=t.route.snapshot.queryParamMap.get("unitId"),t.paramID){t.editing=!0;const i=t.unitService.getUnitById(t.paramID);i&&(t.unitForm.patchValue({name:i.name,rank:t.rankOptions.find(s=>s.value===i.rank),edges:i.edges,image:i.image}),t.edgesSelected=i.edges)}})()}get unit(){const t=this.unitForm.value;return{id:this.editing?this.paramID:Math.random().toString(36).substring(2,9),name:t.name,rank:t.rank.value,edges:t.edges,image:t.image}}get totalCost(){return this.unitService.calcUnitCost(this.unit)}onSubmit(){this.editing?this.unitService.updateUnit(this.unit):this.unitService.addUnit(this.unit),this.navCtrl.navigateBack("/")}toggleEdgeExpansion(t){this.expandedRules.includes(t.name)?this.expandedRules=this.expandedRules.filter(i=>i!==t.name):this.expandedRules.push(t.name)}toggleShowRules(){this.showRules=!this.showRules}toggleEdge(t){this.ruleIsSelected(t)?this.removeEdge(t):this.addEdge(t)}addEdge(t){const i=this.edgesSelected.find(s=>s.name===t.name);i?(this.removeEdge(i),this.addEdge(t)):(this.edgesSelected.push(t),this.unitForm.controls.edges.setValue(this.edgesSelected))}removeEdge(t){this.edgesSelected=this.edgesSelected.filter(i=>i.name!==t.name),this.unitForm.controls.edges.setValue(this.edgesSelected)}ruleIsSelected(t){return this.edgesSelected.some(i=>i.name===t.name)}onFileChange(t){const i=t.target.files[0];if(!i)return;const s=new FileReader;s.onload=()=>{this.unitForm.controls.image.setValue(s.result)},s.readAsDataURL(i)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(o.SH),e.Y36(f._),e.Y36(v.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-unit-editor"]],viewQuery:function(t,i){if(1&t&&e.Gf(_,5),2&t){let s;e.iGM(s=e.CRH())&&(i.fileInput=s.first)}},standalone:!0,features:[e.jDz],decls:30,vars:10,consts:[["slot","start"],[3,"formGroup","ngSubmit"],["formControlName","name","label","Unit Name"],["formControlName","rank","label","Rank"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],["id","rules-list",4,"ngIf"],["formControlName","image","type","url","label","Image URL (optional)",2,"overflow","hidden"],["slot","end",3,"click"],["type","file","hidden","","accept","image/*",3,"change"],["fileInput",""],[2,"display","flex","justify-content","center"],[2,"max-width","100%","max-height","100px",3,"src"],[4,"ngIf"],["expand","block","type","submit",3,"disabled"],[3,"value"],["id","rules-list"],[4,"ngFor","ngForOf"],[2,"flex","1",3,"click"],["style","margin-left:20px",4,"ngIf"],["slot","end",1,"custom-checkbox",3,"ngClass","click"],["name","checkmark","style","color: white;",4,"ngIf"],[2,"margin-left","20px"],["name","checkmark",2,"color","white"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-content")(7,"form",1),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(8,"ion-list")(9,"ion-item"),e._UZ(10,"ion-input",2),e.qZA(),e.TgZ(11,"ion-item")(12,"ion-select",3),e.YNc(13,y,2,3,"ion-select-option",4),e.qZA()(),e.TgZ(14,"ion-item",5),e.NdJ("click",function(){return i.toggleShowRules()}),e.TgZ(15,"ion-label"),e._uU(16),e.qZA()(),e.YNc(17,I,2,1,"div",6),e.TgZ(18,"ion-item"),e._UZ(19,"ion-input",7),e.TgZ(20,"ion-button",8),e.NdJ("click",function(){e.CHM(s);const d=e.MAs(23);return e.KtG(d.click())}),e._uU(21,"Upload"),e.qZA(),e.TgZ(22,"input",9,10),e.NdJ("change",function(d){return i.onFileChange(d)}),e.qZA()(),e.TgZ(24,"div",11),e._UZ(25,"img",12),e.qZA(),e.YNc(26,U,3,2,"ion-item",13),e.YNc(27,S,3,2,"ion-item",13),e.qZA(),e.TgZ(28,"ion-button",14),e._uU(29),e.qZA()()()}2&t&&(e.xp6(5),e.hij("",i.editing?"Edit":"Create"," Unit"),e.xp6(2),e.Q6J("formGroup",i.unitForm),e.xp6(6),e.Q6J("ngForOf",i.rankOptions),e.xp6(3),e.hij("Edges (click to ",i.showRules?"hide":"show",")"),e.xp6(1),e.Q6J("ngIf",i.showRules),e.xp6(8),e.Q6J("src",i.unitForm.value.image||"assets/default-unit-image.png",e.LSH),e.xp6(1),e.Q6J("ngIf",i.unitForm.value.name&&i.unitForm.value.rank),e.xp6(1),e.Q6J("ngIf",i.unitForm.value.edges.length>3),e.xp6(1),e.Q6J("disabled",i.unitForm.invalid),e.xp6(1),e.hij("",i.editing?"Save":"Create"," Unit"))},dependencies:[o.Pc,o.oU,o.YG,o.Sm,o.W2,o.Gu,o.gu,o.pK,o.Ie,o.Q$,o.q_,o.t9,o.n0,o.wd,o.sr,o.QI,o.j9,o.cs,u.ez,u.mk,u.sg,u.O5,a.UX,a._Y,a.JJ,a.JL,a.sg,a.u],styles:["#rules-list[_ngcontent-%COMP%]{height:50vh;overflow-y:scroll;margin-left:40px}.custom-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:50%;background-color:#fff;border:2px solid var(--ion-color-primary);transition:background-color .3s}.custom-checkbox.selected[_ngcontent-%COMP%]{background-color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}"]}),n})()}}]);